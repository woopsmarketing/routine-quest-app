#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# ğŸ” Conventional Commits ê²€ì‚¬
echo "ğŸ” ì»¤ë°‹ ë©”ì‹œì§€ í˜•ì‹ì„ ê²€ì‚¬í•©ë‹ˆë‹¤..."

# ì»¤ë°‹ ë©”ì‹œì§€ íŒŒì¼ ì½ê¸°
commit_message=$(cat $1)

# Conventional Commits íŒ¨í„´
# type(scope): description
# ì˜ˆ: feat(api): add user authentication endpoint
conventional_pattern="^(feat|fix|docs|style|refactor|test|chore|ci|build|perf)(\(.+\))?: .{1,100}$"

if [[ ! $commit_message =~ $conventional_pattern ]]; then
    echo "âŒ ì»¤ë°‹ ë©”ì‹œì§€ê°€ Conventional Commits í˜•ì‹ì— ë§ì§€ ì•ŠìŠµë‹ˆë‹¤!"
    echo ""
    echo "ì˜¬ë°”ë¥¸ í˜•ì‹:"
    echo "  type(scope): description"
    echo ""
    echo "íƒ€ì… (í•„ìˆ˜):"
    echo "  feat:     ìƒˆë¡œìš´ ê¸°ëŠ¥"
    echo "  fix:      ë²„ê·¸ ìˆ˜ì •"
    echo "  docs:     ë¬¸ì„œ ë³€ê²½"
    echo "  style:    ì½”ë“œ ìŠ¤íƒ€ì¼ ë³€ê²½ (ë¡œì§ ë³€ê²½ ì—†ìŒ)"
    echo "  refactor: ë¦¬íŒ©í† ë§"
    echo "  test:     í…ŒìŠ¤íŠ¸ ì¶”ê°€/ìˆ˜ì •"
    echo "  chore:    ë¹Œë“œ/ì„¤ì • ë³€ê²½"
    echo "  ci:       CI/CD ì„¤ì • ë³€ê²½"
    echo "  build:    ë¹Œë“œ ì‹œìŠ¤í…œ ë³€ê²½"
    echo "  perf:     ì„±ëŠ¥ ê°œì„ "
    echo ""
    echo "ìŠ¤ì½”í”„ (ì„ íƒ):"
    echo "  api, ai, client, shared, docker, scripts"
    echo ""
    echo "ì˜ˆì‹œ:"
    echo "  feat(api): add user authentication endpoint"
    echo "  fix(client): resolve navigation bug"
    echo "  docs: update README with setup instructions"
    echo ""
    exit 1
fi

echo "âœ… ì»¤ë°‹ ë©”ì‹œì§€ í˜•ì‹ì´ ì˜¬ë°”ë¦…ë‹ˆë‹¤!"